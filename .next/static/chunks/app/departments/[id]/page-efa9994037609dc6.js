(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[814],{1988:function(e,t,s){Promise.resolve().then(s.bind(s,7370))},7370:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return y}});var a=s(7437),n=s(2265),r=s(5452),l=s(9376),i=s(8387),d=s(2869),c=s(6070),m=s(5974),x=s(4630),o=s(8420),h=s(9397),u=s(1239),f=s(5805),p=s(2222),j=s(4401),g=s(6221),v=s(7648);function y(){var e,t;let[s,y]=(0,n.useState)(null),[N,b]=(0,n.useState)(""),[k,w]=(0,n.useState)(null),[Z,_]=(0,n.useState)([]),[M,A]=(0,n.useState)({activeAgents:0,workflows:0,tasksCompleted:0,timeSaved:0}),[z,C]=(0,n.useState)(!0),[q,S]=(0,n.useState)(!1),D=(0,l.useRouter)(),O=(0,l.useParams)().id,V=(0,r.createClientComponentClient)();(0,n.useEffect)(()=>{let e=async()=>{var e;let{data:{user:t}}=await V.auth.getUser();if(!t){D.push("/auth/login");return}y(t);let{data:s}=await V.from("organization_members").select("role, organization_id").eq("user_id",t.id).single();if(!s){D.push("/organization/setup");return}b(s.role);let a=!1;if("owner"===s.role||"admin"===s.role)a=!0;else{let{data:e}=await V.from("department_members").select("id").eq("department_id",O).eq("user_id",t.id).single();a=!!e}if(!a){alert("You do not have access to this department"),D.push("/departments");return}S(!0);let{data:n,error:r}=await V.from("departments").select("\n          id,\n          name,\n          description,\n          head_user_id,\n          created_at,\n          profiles!head_user_id(\n            full_name,\n            email\n          )\n        ").eq("id",O).single();if(r||!n){console.error("Error loading department:",r),D.push("/departments");return}let{count:l}=await V.from("department_members").select("id",{count:"exact"}).eq("department_id",O),{count:i}=await V.from("agent_department_associations").select("id",{count:"exact"}).eq("department_id",O);w({...n,head_user:(null===(e=n.profiles)||void 0===e?void 0:e[0])||null,member_count:l||0,agent_count:i||0});let{data:d}=await V.from("agent_department_associations").select("\n          agents (\n            id,\n            name,\n            description,\n            model_provider,\n            model_name,\n            created_at\n          )\n        ").eq("department_id",O),c=(null==d?void 0:d.map(e=>e.agents).filter(Boolean))||[];_(c);let{data:m}=await V.from("ai_usage_logs").select("input_tokens, output_tokens, duration_ms").eq("department_id",O).order("created_at",{ascending:!1}).limit(100),x=(null==m?void 0:m.length)||0,o=(null==m?void 0:m.reduce((e,t)=>e+(t.duration_ms||0),0))||0;A({activeAgents:c.length,workflows:0,tasksCompleted:x,timeSaved:Math.round(o/6e4)}),C(!1)};O&&e()},[D,V,O]);let Y=["owner","admin"].includes(N);return z?(0,a.jsx)(i.Z,{children:(0,a.jsx)("div",{className:"flex items-center justify-center min-h-[400px]",children:(0,a.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-primary"})})}):k&&q?(0,a.jsx)(i.Z,{children:(0,a.jsxs)("div",{className:"p-6",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-8",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{className:"text-3xl font-bold text-gray-900",children:k.name}),(0,a.jsx)("p",{className:"text-gray-600 mt-1",children:k.description||"Department dashboard and management"})]}),Y&&(0,a.jsx)(v.default,{href:"/departments/".concat(k.id,"/edit"),children:(0,a.jsxs)(d.z,{variant:"outline",className:"flex items-center space-x-2",children:[(0,a.jsx)(x.Z,{className:"h-4 w-4"}),(0,a.jsx)("span",{children:"Edit Department"})]})})]}),(0,a.jsxs)(c.Zb,{className:"mb-8",children:[(0,a.jsx)(c.Ol,{children:(0,a.jsxs)(c.ll,{className:"flex items-center space-x-2",children:[(0,a.jsx)(o.Z,{className:"h-5 w-5"}),(0,a.jsx)("span",{children:"Department Information"})]})}),(0,a.jsx)(c.aY,{children:(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm font-medium text-gray-700",children:"Department Head"}),(0,a.jsx)("p",{className:"text-sm text-gray-600",children:(null===(e=k.head_user)||void 0===e?void 0:e.full_name)||(null===(t=k.head_user)||void 0===t?void 0:t.email)||"Not assigned"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm font-medium text-gray-700",children:"Members"}),(0,a.jsxs)("p",{className:"text-sm text-gray-600",children:[k.member_count," members"]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm font-medium text-gray-700",children:"AI Agents"}),(0,a.jsxs)("p",{className:"text-sm text-gray-600",children:[k.agent_count," agents"]})]})]})})]}),(0,a.jsxs)("div",{className:"mb-8",children:[(0,a.jsx)("h2",{className:"text-xl font-semibold text-gray-900 mb-4",children:"Quick Actions"}),(0,a.jsxs)("div",{className:"flex flex-wrap gap-4",children:[(0,a.jsx)(v.default,{href:"/departments/".concat(k.id,"/agents/create"),children:(0,a.jsxs)(d.z,{className:"flex items-center space-x-2",children:[(0,a.jsx)(h.Z,{className:"h-4 w-4"}),(0,a.jsx)("span",{children:"Create Agent"})]})}),(0,a.jsx)(v.default,{href:"/workflows/create",children:(0,a.jsxs)(d.z,{variant:"outline",className:"flex items-center space-x-2",children:[(0,a.jsx)(u.Z,{className:"h-4 w-4"}),(0,a.jsx)("span",{children:"New Workflow"})]})}),Y&&(0,a.jsx)(v.default,{href:"/departments/".concat(k.id,"/members"),children:(0,a.jsxs)(d.z,{variant:"outline",className:"flex items-center space-x-2",children:[(0,a.jsx)(f.Z,{className:"h-4 w-4"}),(0,a.jsx)("span",{children:"Manage Members"})]})})]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8",children:[(0,a.jsxs)(c.Zb,{children:[(0,a.jsxs)(c.Ol,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,a.jsx)(c.ll,{className:"text-sm font-medium",children:"Active Agents"}),(0,a.jsx)(p.Z,{className:"h-4 w-4 text-muted-foreground"})]}),(0,a.jsxs)(c.aY,{children:[(0,a.jsx)("div",{className:"text-2xl font-bold",children:M.activeAgents}),(0,a.jsx)("p",{className:"text-xs text-muted-foreground",children:"In this department"})]})]}),(0,a.jsxs)(c.Zb,{children:[(0,a.jsxs)(c.Ol,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,a.jsx)(c.ll,{className:"text-sm font-medium",children:"Workflows"}),(0,a.jsx)(u.Z,{className:"h-4 w-4 text-muted-foreground"})]}),(0,a.jsxs)(c.aY,{children:[(0,a.jsx)("div",{className:"text-2xl font-bold",children:M.workflows}),(0,a.jsx)("p",{className:"text-xs text-muted-foreground",children:"Available"})]})]}),(0,a.jsxs)(c.Zb,{children:[(0,a.jsxs)(c.Ol,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,a.jsx)(c.ll,{className:"text-sm font-medium",children:"Tasks Completed"}),(0,a.jsx)(j.Z,{className:"h-4 w-4 text-muted-foreground"})]}),(0,a.jsxs)(c.aY,{children:[(0,a.jsx)("div",{className:"text-2xl font-bold",children:M.tasksCompleted}),(0,a.jsx)("p",{className:"text-xs text-muted-foreground",children:"This month"})]})]}),(0,a.jsxs)(c.Zb,{children:[(0,a.jsxs)(c.Ol,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,a.jsx)(c.ll,{className:"text-sm font-medium",children:"Time Saved"}),(0,a.jsx)(g.Z,{className:"h-4 w-4 text-muted-foreground"})]}),(0,a.jsxs)(c.aY,{children:[(0,a.jsxs)("div",{className:"text-2xl font-bold",children:[M.timeSaved,"min"]}),(0,a.jsx)("p",{className:"text-xs text-muted-foreground",children:"This month"})]})]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8",children:[(0,a.jsxs)(c.Zb,{children:[(0,a.jsxs)(c.Ol,{children:[(0,a.jsxs)(c.ll,{className:"flex items-center space-x-2",children:[(0,a.jsx)(p.Z,{className:"h-5 w-5"}),(0,a.jsx)("span",{children:"AI Agents"})]}),(0,a.jsx)(c.SZ,{children:"Agents available in this department"})]}),(0,a.jsx)(c.aY,{children:0===Z.length?(0,a.jsxs)("div",{className:"text-center py-8",children:[(0,a.jsx)(p.Z,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),(0,a.jsx)("p",{className:"text-gray-600",children:"No agents in this department yet"}),(0,a.jsx)(v.default,{href:"/departments/".concat(k.id,"/agents/create"),className:"mt-4 inline-block",children:(0,a.jsx)(d.z,{size:"sm",children:"Create First Agent"})})]}):(0,a.jsxs)("div",{className:"space-y-4",children:[Z.slice(0,5).map(e=>(0,a.jsxs)("div",{className:"flex items-start space-x-3 p-3 border rounded-lg",children:[(0,a.jsx)("div",{className:"h-10 w-10 bg-primary/10 rounded-lg flex items-center justify-center",children:(0,a.jsx)(p.Z,{className:"h-5 w-5 text-primary"})}),(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsx)("h4",{className:"font-medium",children:e.name}),(0,a.jsx)("p",{className:"text-sm text-gray-600",children:e.description||"No description"}),(0,a.jsxs)("div",{className:"flex items-center space-x-2 mt-1",children:[(0,a.jsx)(m.C,{variant:"outline",className:"text-xs",children:e.model_provider}),(0,a.jsx)(m.C,{variant:"outline",className:"text-xs",children:e.model_name})]})]})]},e.id)),Z.length>5&&(0,a.jsx)("div",{className:"text-center",children:(0,a.jsx)(v.default,{href:"/departments/".concat(k.id,"/agents"),children:(0,a.jsxs)(d.z,{variant:"outline",size:"sm",children:["View All Agents (",Z.length,")"]})})})]})})]}),(0,a.jsxs)(c.Zb,{children:[(0,a.jsxs)(c.Ol,{children:[(0,a.jsxs)(c.ll,{className:"flex items-center space-x-2",children:[(0,a.jsx)(j.Z,{className:"h-5 w-5"}),(0,a.jsx)("span",{children:"Recent Activity"})]}),(0,a.jsx)(c.SZ,{children:"Latest actions in this department"})]}),(0,a.jsxs)(c.aY,{children:[(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"flex items-start space-x-3",children:[(0,a.jsx)("div",{className:"h-2 w-2 bg-green-500 rounded-full mt-2"}),(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsx)("p",{className:"text-sm",children:"Department created"}),(0,a.jsx)("p",{className:"text-xs text-gray-500",children:new Date(k.created_at).toLocaleDateString()})]})]}),Z.length>0&&(0,a.jsxs)("div",{className:"flex items-start space-x-3",children:[(0,a.jsx)("div",{className:"h-2 w-2 bg-blue-500 rounded-full mt-2"}),(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsx)("p",{className:"text-sm",children:"AI agents deployed"}),(0,a.jsxs)("p",{className:"text-xs text-gray-500",children:[Z.length," agents active"]})]})]}),(0,a.jsxs)("div",{className:"flex items-start space-x-3",children:[(0,a.jsx)("div",{className:"h-2 w-2 bg-purple-500 rounded-full mt-2"}),(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsx)("p",{className:"text-sm",children:"Team members added"}),(0,a.jsxs)("p",{className:"text-xs text-gray-500",children:[k.member_count," members"]})]})]})]}),(0,a.jsx)("div",{className:"mt-4",children:(0,a.jsx)(v.default,{href:"/analytics",children:(0,a.jsx)(d.z,{className:"w-full",children:"View Full Analytics"})})})]})]})]})]})}):(0,a.jsx)(i.Z,{children:(0,a.jsx)("div",{className:"flex items-center justify-center min-h-[400px]",children:(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("h2",{className:"text-xl font-semibold text-gray-900",children:"Access Denied"}),(0,a.jsx)("p",{className:"text-gray-600 mt-2",children:"You don't have permission to view this department."}),(0,a.jsx)(d.z,{onClick:()=>D.push("/departments"),className:"mt-4",children:"Back to Departments"})]})})})}},5974:function(e,t,s){"use strict";s.d(t,{C:function(){return i}});var a=s(7437);s(2265);var n=s(535),r=s(4508);let l=(0,n.j)("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function i(e){let{className:t,variant:s,...n}=e;return(0,a.jsx)("div",{className:(0,r.cn)(l({variant:s}),t),...n})}},4401:function(e,t,s){"use strict";s.d(t,{Z:function(){return a}});let a=(0,s(9763).Z)("Activity",[["path",{d:"M22 12h-4l-3 9L9 3l-3 9H2",key:"d5dnw9"}]])},6221:function(e,t,s){"use strict";s.d(t,{Z:function(){return a}});let a=(0,s(9763).Z)("BarChart3",[["path",{d:"M3 3v18h18",key:"1s2lah"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]])},2222:function(e,t,s){"use strict";s.d(t,{Z:function(){return a}});let a=(0,s(9763).Z)("Bot",[["path",{d:"M12 8V4H8",key:"hb8ula"}],["rect",{width:"16",height:"12",x:"4",y:"8",rx:"2",key:"enze0r"}],["path",{d:"M2 14h2",key:"vft8re"}],["path",{d:"M20 14h2",key:"4cs60a"}],["path",{d:"M15 13v2",key:"1xurst"}],["path",{d:"M9 13v2",key:"rq6x2g"}]])},8420:function(e,t,s){"use strict";s.d(t,{Z:function(){return a}});let a=(0,s(9763).Z)("Building2",[["path",{d:"M6 22V4a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v18Z",key:"1b4qmf"}],["path",{d:"M6 12H4a2 2 0 0 0-2 2v6a2 2 0 0 0 2 2h2",key:"i71pzd"}],["path",{d:"M18 9h2a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2h-2",key:"10jefs"}],["path",{d:"M10 6h4",key:"1itunk"}],["path",{d:"M10 10h4",key:"tcdvrf"}],["path",{d:"M10 14h4",key:"kelpxr"}],["path",{d:"M10 18h4",key:"1ulq68"}]])},875:function(e,t,s){"use strict";s.d(t,{Z:function(){return a}});let a=(0,s(9763).Z)("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]])},407:function(e,t,s){"use strict";s.d(t,{Z:function(){return a}});let a=(0,s(9763).Z)("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]])},8293:function(e,t,s){"use strict";s.d(t,{Z:function(){return a}});let a=(0,s(9763).Z)("Menu",[["line",{x1:"4",x2:"20",y1:"12",y2:"12",key:"1e0a9i"}],["line",{x1:"4",x2:"20",y1:"6",y2:"6",key:"1owob3"}],["line",{x1:"4",x2:"20",y1:"18",y2:"18",key:"yk5zj1"}]])},4630:function(e,t,s){"use strict";s.d(t,{Z:function(){return a}});let a=(0,s(9763).Z)("PenSquare",[["path",{d:"M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1qinfi"}],["path",{d:"M18.5 2.5a2.12 2.12 0 0 1 3 3L12 15l-4 1 1-4Z",key:"w2jsv5"}]])},9397:function(e,t,s){"use strict";s.d(t,{Z:function(){return a}});let a=(0,s(9763).Z)("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]])},8728:function(e,t,s){"use strict";s.d(t,{Z:function(){return a}});let a=(0,s(9763).Z)("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]])},5805:function(e,t,s){"use strict";s.d(t,{Z:function(){return a}});let a=(0,s(9763).Z)("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]])},2489:function(e,t,s){"use strict";s.d(t,{Z:function(){return a}});let a=(0,s(9763).Z)("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]])},1239:function(e,t,s){"use strict";s.d(t,{Z:function(){return a}});let a=(0,s(9763).Z)("Zap",[["polygon",{points:"13 2 3 14 12 14 11 22 21 10 12 10 13 2",key:"45s27k"}]])},7648:function(e,t,s){"use strict";s.d(t,{default:function(){return n.a}});var a=s(2972),n=s.n(a)}},function(e){e.O(0,[284,523,972,672,971,117,744],function(){return e(e.s=1988)}),_N_E=e.O()}]);