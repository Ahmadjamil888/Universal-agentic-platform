(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[297],{7341:function(e,t,s){Promise.resolve().then(s.bind(s,9215))},9215:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return y}});var a=s(7437),n=s(2265),r=s(5452),i=s(9376),d=s(8387),l=s(2869),c=s(6070),o=s(5974),m=s(9397),f=s(2222),x=s(7684),u=s(9763);let h=(0,u.Z)("Pause",[["rect",{width:"4",height:"16",x:"6",y:"4",key:"iffhe4"}],["rect",{width:"4",height:"16",x:"14",y:"4",key:"sjin7j"}]]),p=(0,u.Z)("Play",[["polygon",{points:"5 3 19 12 5 21 5 3",key:"191637"}]]);var g=s(4630),j=s(8930),v=s(7648),N=s(4190);function y(){let[e,t]=(0,n.useState)(null),[s,u]=(0,n.useState)(""),[y,b]=(0,n.useState)(null),[w,_]=(0,n.useState)([]),[Z,z]=(0,n.useState)(!0),[C,k]=(0,n.useState)(!1),A=(0,i.useRouter)(),R=(0,i.useParams)().id,q=(0,r.createClientComponentClient)();(0,n.useEffect)(()=>{let e=async()=>{let{data:{user:e}}=await q.auth.getUser();if(!e){A.push("/auth/login");return}t(e);let{data:s}=await q.from("organization_members").select("role, organization_id").eq("user_id",e.id).single();if(!s){A.push("/organization/setup");return}u(s.role);let a=!1;if("owner"===s.role||"admin"===s.role)a=!0;else{let{data:t}=await q.from("department_members").select("id").eq("department_id",R).eq("user_id",e.id).single();a=!!t}if(!a){alert("You do not have access to this department"),A.push("/departments");return}k(!0);let{data:n,error:r}=await q.from("departments").select("id, name").eq("id",R).single();if(r||!n){console.error("Error loading department:",r),A.push("/departments");return}b(n);let{data:i}=await q.from("agent_department_associations").select("\n          agents (\n            id,\n            name,\n            description,\n            model_provider,\n            model_name,\n            config,\n            created_at\n          )\n        ").eq("department_id",R);_((null==i?void 0:i.map(e=>{var t,s;return{...e.agents,is_active:(null===(s=e.agents)||void 0===s?void 0:null===(t=s.config)||void 0===t?void 0:t.is_active)||!1}}).filter(Boolean))||[]),z(!1)};R&&e()},[A,q,R]);let E=async(e,t)=>{try{var s;let{error:a}=await q.from("agents").update({config:{...null===(s=w.find(t=>t.id===e))||void 0===s?void 0:s.config,is_active:!t}}).eq("id",e);if(a)throw a;_(w.map(s=>s.id===e?{...s,is_active:!t}:s))}catch(e){console.error("Error toggling agent status:",e),alert("Failed to update agent status")}},F=async e=>{if(confirm("Are you sure you want to delete this agent? This action cannot be undone."))try{await q.from("agent_department_associations").delete().eq("agent_id",e).eq("department_id",R);let{error:t}=await q.from("agents").delete().eq("id",e);if(t)throw t;_(w.filter(t=>t.id!==e))}catch(e){console.error("Error deleting agent:",e),alert("Failed to delete agent. Please try again.")}};return Z?(0,a.jsx)(d.Z,{children:(0,a.jsx)("div",{className:"flex items-center justify-center min-h-[400px]",children:(0,a.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-primary"})})}):y&&C?(0,a.jsx)(d.Z,{children:(0,a.jsxs)("div",{className:"p-6",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-8",children:[(0,a.jsxs)("div",{children:[(0,a.jsxs)("h1",{className:"text-3xl font-bold text-gray-900",children:["AI Agents - ",y.name]}),(0,a.jsx)("p",{className:"text-gray-600 mt-1",children:"Manage AI agents for this department"})]}),(0,a.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,a.jsx)(v.default,{href:"/departments/".concat(y.id),children:(0,a.jsx)(l.z,{variant:"outline",children:"Back to Department"})}),(0,a.jsx)(v.default,{href:"/departments/".concat(y.id,"/agents/create"),children:(0,a.jsxs)(l.z,{className:"flex items-center space-x-2",children:[(0,a.jsx)(m.Z,{className:"h-4 w-4"}),(0,a.jsx)("span",{children:"Create Agent"})]})})]})]}),0===w.length?(0,a.jsx)(c.Zb,{children:(0,a.jsxs)(c.aY,{className:"flex flex-col items-center justify-center py-16",children:[(0,a.jsx)(f.Z,{className:"h-12 w-12 text-gray-400 mb-4"}),(0,a.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No agents found"}),(0,a.jsx)("p",{className:"text-gray-600 text-center mb-6",children:"Get started by creating your first AI agent for this department"}),(0,a.jsx)(v.default,{href:"/departments/".concat(y.id,"/agents/create"),children:(0,a.jsxs)(l.z,{children:[(0,a.jsx)(m.Z,{className:"h-4 w-4 mr-2"}),"Create Agent"]})})]})}):(0,a.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:w.map(e=>(0,a.jsxs)(c.Zb,{className:"hover:shadow-lg transition-shadow",children:[(0,a.jsx)(c.Ol,{children:(0,a.jsxs)("div",{className:"flex items-start justify-between",children:[(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsxs)(c.ll,{className:"text-lg flex items-center space-x-2",children:[(0,a.jsx)(f.Z,{className:"h-5 w-5 text-primary"}),(0,a.jsx)("span",{children:e.name})]}),(0,a.jsx)(c.SZ,{className:"mt-1",children:e.description||"No description provided"})]}),(0,a.jsxs)(N.h_,{children:[(0,a.jsx)(N.$F,{asChild:!0,children:(0,a.jsx)(l.z,{variant:"ghost",size:"sm",children:(0,a.jsx)(x.Z,{className:"h-4 w-4"})})}),(0,a.jsxs)(N.AW,{align:"end",children:[(0,a.jsx)(N.Xi,{onClick:()=>E(e.id,e.is_active||!1),children:e.is_active?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(h,{className:"h-4 w-4 mr-2"}),"Deactivate"]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(p,{className:"h-4 w-4 mr-2"}),"Activate"]})}),(0,a.jsx)(N.Xi,{asChild:!0,children:(0,a.jsxs)(v.default,{href:"/departments/".concat(y.id,"/agents/").concat(e.id,"/edit"),children:[(0,a.jsx)(g.Z,{className:"h-4 w-4 mr-2"}),"Edit"]})}),(0,a.jsxs)(N.Xi,{onClick:()=>F(e.id),className:"text-red-600",children:[(0,a.jsx)(j.Z,{className:"h-4 w-4 mr-2"}),"Delete"]})]})]})]})}),(0,a.jsx)(c.aY,{children:(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)("div",{className:"h-2 w-2 rounded-full ".concat(e.is_active?"bg-green-500":"bg-gray-400")}),(0,a.jsx)("span",{className:"text-sm text-gray-600",children:e.is_active?"Active":"Inactive"})]}),(0,a.jsx)(o.C,{variant:"secondary",className:"text-xs",children:e.model_provider})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm font-medium text-gray-700",children:"Model"}),(0,a.jsx)("p",{className:"text-sm text-gray-600",children:e.model_name})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm font-medium text-gray-700",children:"Created"}),(0,a.jsx)("p",{className:"text-sm text-gray-600",children:new Date(e.created_at).toLocaleDateString()})]}),(0,a.jsxs)("div",{className:"flex space-x-2",children:[(0,a.jsx)(l.z,{variant:"outline",size:"sm",className:"flex-1",children:"Test Agent"}),(0,a.jsx)(l.z,{size:"sm",className:"flex-1",children:"Configure"})]})]})})]},e.id))})]})}):(0,a.jsx)(d.Z,{children:(0,a.jsx)("div",{className:"flex items-center justify-center min-h-[400px]",children:(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("h2",{className:"text-xl font-semibold text-gray-900",children:"Access Denied"}),(0,a.jsx)("p",{className:"text-gray-600 mt-2",children:"You don't have permission to view this department."}),(0,a.jsx)(l.z,{onClick:()=>A.push("/departments"),className:"mt-4",children:"Back to Departments"})]})})})}},5974:function(e,t,s){"use strict";s.d(t,{C:function(){return d}});var a=s(7437);s(2265);var n=s(535),r=s(4508);let i=(0,n.j)("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function d(e){let{className:t,variant:s,...n}=e;return(0,a.jsx)("div",{className:(0,r.cn)(i({variant:s}),t),...n})}},4190:function(e,t,s){"use strict";s.d(t,{$F:function(){return m},AW:function(){return f},Xi:function(){return x},h_:function(){return o}});var a=s(7437),n=s(2265),r=s(3032),i=s(407),d=s(401),l=s(519),c=s(4508);let o=r.fC,m=r.xz;r.ZA,r.Uv,r.Tr,r.Ee,n.forwardRef((e,t)=>{let{className:s,inset:n,children:d,...l}=e;return(0,a.jsxs)(r.fF,{ref:t,className:(0,c.cn)("flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent data-[state=open]:bg-accent",n&&"pl-8",s),...l,children:[d,(0,a.jsx)(i.Z,{className:"ml-auto h-4 w-4"})]})}).displayName=r.fF.displayName,n.forwardRef((e,t)=>{let{className:s,...n}=e;return(0,a.jsx)(r.tu,{ref:t,className:(0,c.cn)("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-lg data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",s),...n})}).displayName=r.tu.displayName;let f=n.forwardRef((e,t)=>{let{className:s,sideOffset:n=4,...i}=e;return(0,a.jsx)(r.Uv,{children:(0,a.jsx)(r.VY,{ref:t,sideOffset:n,className:(0,c.cn)("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",s),...i})})});f.displayName=r.VY.displayName;let x=n.forwardRef((e,t)=>{let{className:s,inset:n,...i}=e;return(0,a.jsx)(r.ck,{ref:t,className:(0,c.cn)("relative flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",n&&"pl-8",s),...i})});x.displayName=r.ck.displayName,n.forwardRef((e,t)=>{let{className:s,children:n,checked:i,...l}=e;return(0,a.jsxs)(r.oC,{ref:t,className:(0,c.cn)("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",s),checked:i,...l,children:[(0,a.jsx)("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,a.jsx)(r.wU,{children:(0,a.jsx)(d.Z,{className:"h-4 w-4"})})}),n]})}).displayName=r.oC.displayName,n.forwardRef((e,t)=>{let{className:s,children:n,...i}=e;return(0,a.jsxs)(r.Rk,{ref:t,className:(0,c.cn)("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",s),...i,children:[(0,a.jsx)("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,a.jsx)(r.wU,{children:(0,a.jsx)(l.Z,{className:"h-2 w-2 fill-current"})})}),n]})}).displayName=r.Rk.displayName,n.forwardRef((e,t)=>{let{className:s,inset:n,...i}=e;return(0,a.jsx)(r.__,{ref:t,className:(0,c.cn)("px-2 py-1.5 text-sm font-semibold",n&&"pl-8",s),...i})}).displayName=r.__.displayName,n.forwardRef((e,t)=>{let{className:s,...n}=e;return(0,a.jsx)(r.Z0,{ref:t,className:(0,c.cn)("-mx-1 my-1 h-px bg-muted",s),...n})}).displayName=r.Z0.displayName}},function(e){e.O(0,[284,523,972,214,161,853,672,971,117,744],function(){return e(e.s=7341)}),_N_E=e.O()}]);