"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[672],{8387:function(e,s,t){t.d(s,{Z:function(){return w}});var a=t(7437),r=t(2265),n=t(5452),l=t(9376),i=t(7648),d=t(2222),c=t(6221),o=t(8420),m=t(875),x=t(407),u=t(9397),f=t(1239),p=t(4401),h=t(5805),g=t(8728),y=t(4508);function j(e){let{className:s}=e,[t,j]=(0,r.useState)(null),[v,b]=(0,r.useState)(null),[N,w]=(0,r.useState)([]),[C,_]=(0,r.useState)({departments:!0,agents:!0}),k=(0,l.usePathname)(),Z=(0,n.createClientComponentClient)();(0,r.useEffect)(()=>{(async()=>{let{data:{user:e}}=await Z.auth.getUser();if(!e)return;j(e);let{data:s}=await Z.from("organization_members").select("role, department_id, organization_id").eq("user_id",e.id).single();if(s){b({role:s.role,department_id:s.department_id});let e=Z.from("departments").select("id, name, description").eq("organization_id",s.organization_id);"member"===s.role&&s.department_id&&(e=e.eq("id",s.department_id));let{data:t}=await e;w(t||[])}})()},[Z]);let z=e=>{_(s=>({...s,[e]:!s[e]}))},A=e=>k===e,S=(null==v?void 0:v.role)==="owner"||(null==v?void 0:v.role)==="admin",R=(null==v?void 0:v.role)==="member"&&(null==v?void 0:v.department_id);return(0,a.jsxs)("div",{className:(0,y.cn)("flex h-full w-64 flex-col bg-white border-r",s),children:[(0,a.jsx)("div",{className:"flex h-16 items-center border-b px-6",children:(0,a.jsxs)(i.default,{href:"/dashboard",className:"flex items-center space-x-2",children:[(0,a.jsx)(d.Z,{className:"h-6 w-6 text-primary"}),(0,a.jsx)("span",{className:"text-lg font-semibold",children:"UAP"})]})}),(0,a.jsxs)("nav",{className:"flex-1 space-y-2 p-4",children:[(0,a.jsx)("div",{children:(0,a.jsxs)(i.default,{href:"/dashboard",className:(0,y.cn)("flex items-center space-x-2 rounded-lg px-3 py-2 text-sm font-medium hover:bg-gray-100",A("/dashboard")&&"bg-primary/10 text-primary"),children:[(0,a.jsx)(c.Z,{className:"h-4 w-4"}),(0,a.jsx)("span",{children:"Overview"})]})}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("button",{onClick:()=>z("departments"),className:"flex w-full items-center justify-between rounded-lg px-3 py-2 text-sm font-medium hover:bg-gray-100",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)(o.Z,{className:"h-4 w-4"}),(0,a.jsx)("span",{children:"Departments"})]}),C.departments?(0,a.jsx)(m.Z,{className:"h-4 w-4"}):(0,a.jsx)(x.Z,{className:"h-4 w-4"})]}),C.departments&&(0,a.jsxs)("div",{className:"ml-6 mt-1 space-y-1",children:[N.map(e=>(0,a.jsx)(i.default,{href:"/departments/".concat(e.id),className:(0,y.cn)("block rounded-lg px-3 py-2 text-sm hover:bg-gray-100",A("/departments/".concat(e.id))&&"bg-primary/10 text-primary"),children:e.name},e.id)),S&&(0,a.jsxs)(i.default,{href:"/departments/create",className:"flex items-center space-x-1 rounded-lg px-3 py-2 text-sm text-gray-600 hover:bg-gray-100",children:[(0,a.jsx)(u.Z,{className:"h-3 w-3"}),(0,a.jsx)("span",{children:"Add Department"})]})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("button",{onClick:()=>z("agents"),className:"flex w-full items-center justify-between rounded-lg px-3 py-2 text-sm font-medium hover:bg-gray-100",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)(d.Z,{className:"h-4 w-4"}),(0,a.jsx)("span",{children:"AI Agents"})]}),C.agents?(0,a.jsx)(m.Z,{className:"h-4 w-4"}):(0,a.jsx)(x.Z,{className:"h-4 w-4"})]}),C.agents&&(0,a.jsxs)("div",{className:"ml-6 mt-1 space-y-1",children:[(0,a.jsx)(i.default,{href:"/agents",className:(0,y.cn)("block rounded-lg px-3 py-2 text-sm hover:bg-gray-100",A("/agents")&&"bg-primary/10 text-primary"),children:"All Agents"}),N.map(e=>(0,a.jsxs)(i.default,{href:"/departments/".concat(e.id,"/agents"),className:(0,y.cn)("block rounded-lg px-3 py-2 text-sm hover:bg-gray-100",A("/departments/".concat(e.id,"/agents"))&&"bg-primary/10 text-primary"),children:[e.name," Agents"]},"agents-".concat(e.id))),!R&&(0,a.jsxs)(i.default,{href:"/agents/create",className:"flex items-center space-x-1 rounded-lg px-3 py-2 text-sm text-gray-600 hover:bg-gray-100",children:[(0,a.jsx)(u.Z,{className:"h-3 w-3"}),(0,a.jsx)("span",{children:"Create Agent"})]})]})]}),(0,a.jsx)("div",{children:(0,a.jsxs)(i.default,{href:"/workflows",className:(0,y.cn)("flex items-center space-x-2 rounded-lg px-3 py-2 text-sm font-medium hover:bg-gray-100",A("/workflows")&&"bg-primary/10 text-primary"),children:[(0,a.jsx)(f.Z,{className:"h-4 w-4"}),(0,a.jsx)("span",{children:"Workflows"})]})}),(0,a.jsx)("div",{children:(0,a.jsxs)(i.default,{href:"/analytics",className:(0,y.cn)("flex items-center space-x-2 rounded-lg px-3 py-2 text-sm font-medium hover:bg-gray-100",A("/analytics")&&"bg-primary/10 text-primary"),children:[(0,a.jsx)(p.Z,{className:"h-4 w-4"}),(0,a.jsx)("span",{children:"Analytics"})]})}),S&&(0,a.jsx)("div",{children:(0,a.jsxs)(i.default,{href:"/users",className:(0,y.cn)("flex items-center space-x-2 rounded-lg px-3 py-2 text-sm font-medium hover:bg-gray-100",A("/users")&&"bg-primary/10 text-primary"),children:[(0,a.jsx)(h.Z,{className:"h-4 w-4"}),(0,a.jsx)("span",{children:"User Management"})]})}),(0,a.jsx)("div",{className:"pt-4 border-t",children:(0,a.jsxs)(i.default,{href:"/settings",className:(0,y.cn)("flex items-center space-x-2 rounded-lg px-3 py-2 text-sm font-medium hover:bg-gray-100",A("/settings")&&"bg-primary/10 text-primary"),children:[(0,a.jsx)(g.Z,{className:"h-4 w-4"}),(0,a.jsx)("span",{children:"Settings"})]})})]})]})}var v=t(2869),b=t(2489),N=t(8293);function w(e){var s;let{children:t}=e,[i,d]=(0,r.useState)(null),[c,o]=(0,r.useState)(!0),[m,x]=(0,r.useState)(!1),u=(0,l.useRouter)(),f=(0,n.createClientComponentClient)();(0,r.useEffect)(()=>{(async()=>{let{data:{user:e}}=await f.auth.getUser();if(e){let{data:s}=await f.from("organization_members").select("organization_id").eq("user_id",e.id).single();s?d(e):u.push("/organization/setup")}else u.push("/auth/login");o(!1)})()},[u,f]);let p=async()=>{await f.auth.signOut(),u.push("/")};return c?(0,a.jsx)("div",{className:"min-h-screen flex items-center justify-center",children:(0,a.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-primary"})}):(0,a.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[m&&(0,a.jsx)("div",{className:"fixed inset-0 z-40 lg:hidden",onClick:()=>x(!1),children:(0,a.jsx)("div",{className:"absolute inset-0 bg-gray-600 opacity-75"})}),(0,a.jsx)("div",{className:(0,y.cn)("fixed inset-y-0 left-0 z-50 w-64 transform transition-transform duration-300 ease-in-out lg:translate-x-0 lg:static lg:inset-0",m?"translate-x-0":"-translate-x-full"),children:(0,a.jsx)(j,{})}),(0,a.jsxs)("div",{className:"lg:pl-64",children:[(0,a.jsx)("header",{className:"bg-white border-b px-4 py-3 lg:px-6",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)("div",{className:"flex items-center",children:(0,a.jsx)("button",{onClick:()=>x(!m),className:"lg:hidden p-2 rounded-md text-gray-400 hover:text-gray-500 hover:bg-gray-100",children:m?(0,a.jsx)(b.Z,{className:"h-6 w-6"}):(0,a.jsx)(N.Z,{className:"h-6 w-6"})})}),(0,a.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,a.jsxs)("span",{className:"text-sm text-gray-600",children:["Welcome, ",(null==i?void 0:null===(s=i.user_metadata)||void 0===s?void 0:s.full_name)||(null==i?void 0:i.email)]}),(0,a.jsx)(v.z,{variant:"outline",size:"sm",onClick:p,children:"Sign Out"})]})]})}),(0,a.jsx)("main",{className:"flex-1",children:t})]})]})}},2869:function(e,s,t){t.d(s,{z:function(){return c}});var a=t(7437),r=t(2265),n=t(7053),l=t(535),i=t(4508);let d=(0,l.j)("inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),c=r.forwardRef((e,s)=>{let{className:t,variant:r,size:l,asChild:c=!1,...o}=e,m=c?n.g7:"button";return(0,a.jsx)(m,{className:(0,i.cn)(d({variant:r,size:l,className:t})),ref:s,...o})});c.displayName="Button"},6070:function(e,s,t){t.d(s,{Ol:function(){return i},SZ:function(){return c},Zb:function(){return l},aY:function(){return o},ll:function(){return d}});var a=t(7437),r=t(2265),n=t(4508);let l=r.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)("div",{ref:s,className:(0,n.cn)("rounded-lg border bg-card text-card-foreground shadow-sm",t),...r})});l.displayName="Card";let i=r.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)("div",{ref:s,className:(0,n.cn)("flex flex-col space-y-1.5 p-6",t),...r})});i.displayName="CardHeader";let d=r.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)("h3",{ref:s,className:(0,n.cn)("text-2xl font-semibold leading-none tracking-tight",t),...r})});d.displayName="CardTitle";let c=r.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)("p",{ref:s,className:(0,n.cn)("text-sm text-muted-foreground",t),...r})});c.displayName="CardDescription";let o=r.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)("div",{ref:s,className:(0,n.cn)("p-6 pt-0",t),...r})});o.displayName="CardContent",r.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)("div",{ref:s,className:(0,n.cn)("flex items-center p-6 pt-0",t),...r})}).displayName="CardFooter"},4508:function(e,s,t){t.d(s,{cn:function(){return n}});var a=t(1994),r=t(3335);function n(){for(var e=arguments.length,s=Array(e),t=0;t<e;t++)s[t]=arguments[t];return(0,r.m6)((0,a.W)(s))}}}]);